#include "Libs.h"

int main(){

	int listener = crearListener(5455);
	int socketNuevaConexion; // descriptor de socket de nueva conexión aceptada

	// Aceptar conexion entrante
	if ((socketNuevaConexion = accept(listener, NULL, 0)) == -1)
	 error_show("Accept");


	char* buffer = malloc(4); //hasta tamaño 999
	recibir(socketNuevaConexion, buffer, 4);

	printf("Listo para recibir mensaje de tamaño %d \n",atoi(buffer));

	char* buffer2 = malloc(atoi(buffer));
	recibir(socketNuevaConexion, buffer2, atoi(buffer));

	printf("Mensaje : %s \n", buffer2);



	return 0;
}
